"use strict";(self.webpackChunkduroom_docs=self.webpackChunkduroom_docs||[]).push([[1177],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return d}});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=o.createContext({}),m=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=m(e.components);return o.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},c=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=m(n),d=r,h=c["".concat(l,".").concat(d)]||c[d]||p[d]||a;return n?o.createElement(h,i(i({ref:t},u),{},{components:n})):o.createElement(h,i({ref:t},u))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var m=2;m<a;m++)i[m]=n[m];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}c.displayName="MDXCreateElement"},1718:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return s},metadata:function(){return m},toc:function(){return p}});var o=n(7462),r=n(3366),a=(n(7294),n(3905)),i=["components"],s={},l="Forms and Requests",m={unversionedId:"extend/forms",id:"extend/forms",title:"Forms and Requests",description:"In this article, we'll go over some frontend tools that are available to us for building and managing forms, as well how to send HTTP requests via DuRoom.",source:"@site/docs/extend/forms.md",sourceDirName:"extend",slug:"/extend/forms",permalink:"/docs/extend/forms",draft:!1,editUrl:"https://github.com/DuRoom/docs/tree/master/docs/extend/forms.md",tags:[],version:"current",frontMatter:{},sidebar:"extendSidebar",previous:{title:"Translating DuRoom",permalink:"/docs/extend/language-packs"},next:{title:"Groups and Permissions",permalink:"/docs/extend/permissions"}},u={},p=[{value:"Form Components",id:"form-components",level:2},{value:"Streams, bidi, and withAttr",id:"streams-bidi-and-withattr",level:2},{value:"Making Requests",id:"making-requests",level:2}],c={toc:p};function d(e){var t=e.components,n=(0,r.Z)(e,i);return(0,a.kt)("wrapper",(0,o.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"forms-and-requests"},"Forms and Requests"),(0,a.kt)("p",null,"In this article, we'll go over some frontend tools that are available to us for building and managing forms, as well how to send HTTP requests via DuRoom."),(0,a.kt)("h2",{id:"form-components"},"Form Components"),(0,a.kt)("p",null,"As with any interactive site, you will likely want to include forms in some pages and modals.\nDuRoom provides some components to make building (and styling!) these forms easier.\nPlease see the linked API documentation for each of these to learn more about its accepted attrs."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The ",(0,a.kt)("a",{parentName:"li",href:"https://api.duroom.js.org/docs/js/master/class/src/common/components/fieldset.js~fieldset"},(0,a.kt)("inlineCode",{parentName:"a"},"duroom/common/components/FieldSet")," component")," wraps its children in a HTML fieldset tag, with a legend."),(0,a.kt)("li",{parentName:"ul"},"The ",(0,a.kt)("a",{parentName:"li",href:"https://api.duroom.js.org/docs/js/master/class/src/common/components/select.js~select"},(0,a.kt)("inlineCode",{parentName:"a"},"duroom/common/components/Select")," component")," is a stylized select input."),(0,a.kt)("li",{parentName:"ul"},"The ",(0,a.kt)("a",{parentName:"li",href:"https://api.duroom.js.org/docs/js/master/class/src/common/components/switch.js~switch"},(0,a.kt)("inlineCode",{parentName:"a"},"duroom/common/components/Switch"))," and ",(0,a.kt)("a",{parentName:"li",href:"https://api.duroom.js.org/docs/js/master/class/src/common/components/checkbox.js~checkbox"},(0,a.kt)("inlineCode",{parentName:"a"},"duroom/common/components/Checkbox")," components")," are stylized checkbox input components. Their ",(0,a.kt)("inlineCode",{parentName:"li"},"loading")," attr can be set to ",(0,a.kt)("inlineCode",{parentName:"li"},"true")," to show a loading indicator."),(0,a.kt)("li",{parentName:"ul"},"The ",(0,a.kt)("a",{parentName:"li",href:"https://api.duroom.js.org/docs/js/master/class/src/common/components/button.js~button"},(0,a.kt)("inlineCode",{parentName:"a"},"duroom/common/components/Button")," component")," is a stylized button, and is used frequently throughout DuRoom.")),(0,a.kt)("p",null,"You'll typically want to assign logic for reacting to input changes via Mithril's ",(0,a.kt)("inlineCode",{parentName:"p"},"on*")," attrs, not external listeners (as is common with jQuery or plain JS). For example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"import Component from 'duroom/common/Component';\nimport FieldSet from 'duroom/common/components/FieldSet';\nimport Button from 'duroom/common/components/Button';\nimport Switch from 'duroom/common/components/Switch';\n\n\nclass FormComponent extends Component {\n  oninit(vnode) {\n    this.textInput = \"\";\n    this.booleanInput = false;\n  }\n\n  view() {\n    return (\n      <form onsubmit={this.onsubmit.bind(this)}>\n        <FieldSet label={app.translator.trans('fake-extension.form.fieldset_label')}>\n          <input className=\"FormControl\" value={this.textInput} oninput={e => this.textInput = e.target.value}>\n          </input>\n          <Switch state={this.booleanInput} onchange={val => this.booleanInput = val}>\n          </Switch>\n        </FieldSet>\n        <Button type=\"submit\">{app.translator.trans('core.admin.basics.submit_button')}</Button>\n      </form>\n    )\n  }\n\n  onsubmit() {\n    // Some form handling logic here\n  }\n}\n")),(0,a.kt)("p",null,"Don't forget to use ",(0,a.kt)("a",{parentName:"p",href:"/docs/extend/i18n"},"translations"),"!"),(0,a.kt)("h2",{id:"streams-bidi-and-withattr"},"Streams, bidi, and withAttr"),(0,a.kt)("p",null,"DuRoom provides ",(0,a.kt)("a",{parentName:"p",href:"https://mithril.js.org/stream.html"},"Mithril's Stream")," as ",(0,a.kt)("inlineCode",{parentName:"p"},"duroom/common/util/Stream"),".\nThis is a very powerful reactive data structure, but is most commonly used in DuRoom as a wrapper for form data.\nIts basic usage is:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'import Stream from \'duroom/common/utils/Stream\';\n\n\nconst value = Stream("hello!");\nvalue() === "hello!"; // true\nvalue("world!");\nvalue() === "world!"; // true\n')),(0,a.kt)("p",null,"In DuRoom forms, streams are frequently used together with the bidi attr.\nBidi stands for bidirectional binding, and is a common pattern in frontend frameworks. DuRoom patches Mithril with the ","[",(0,a.kt)("inlineCode",{parentName:"p"},"m.attrs.bidi")," library]","(",(0,a.kt)("a",{parentName:"p",href:"https://github.com/tobyzerner/m.attrs"},"https://github.com/tobyzerner/m.attrs"),".\nThis abstracts away input processing in Mithril. For instance:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'import Stream from \'duroom/common/utils/Stream\';\n\nconst value = Stream();\n\n// Without bidi\n<input type="text" value={value()} oninput={e => value(e.target.value)}></input>\n\n// With bidi\n<input type="text" bidi={value}></input>\n')),(0,a.kt)("p",null,"You can also use the ",(0,a.kt)("inlineCode",{parentName:"p"},"duroom/common/utils/withAttr")," util for simplified form processing. ",(0,a.kt)("inlineCode",{parentName:"p"},"withAttr")," calls a callable, providing as an argument some attr of the DOM element tied to the component in question:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"import Stream from 'duroom/common/utils/Stream';\nimport withAttr from 'duroom/common/utils/withAttr';\n\nconst value = Stream();\n\n// With a stream\n<input type=\"text\" value={value()} oninput={withAttr('value', value)}></input>\n\n// With any callable\n<input type=\"text\" value={value()} oninput={withAttr('value', (currValue) => {\n  // Some custom logic here\n})}></input>\n")),(0,a.kt)("h2",{id:"making-requests"},"Making Requests"),(0,a.kt)("p",null,"In our ",(0,a.kt)("a",{parentName:"p",href:"/docs/extend/models"},"models")," documentation, you learned how to work with models, and save model creation, changes, and deletion to the database via the Store util, which is just a wrapper around DuRoom's request system, which itself is just a wrapper around ",(0,a.kt)("a",{parentName:"p",href:"https://mithril.js.org/request.html"},"Mithril's request system"),"."),(0,a.kt)("p",null,"DuRoom's request system is available globally via ",(0,a.kt)("inlineCode",{parentName:"p"},"app.request(options)"),", and has the following differences from Mithril's ",(0,a.kt)("inlineCode",{parentName:"p"},"m.request(options)"),":"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"It will automatically attach ",(0,a.kt)("inlineCode",{parentName:"li"},"X-CSRF-Token")," headers."),(0,a.kt)("li",{parentName:"ul"},"It will convert ",(0,a.kt)("inlineCode",{parentName:"li"},"PATCH")," and ",(0,a.kt)("inlineCode",{parentName:"li"},"DELETE")," requests into ",(0,a.kt)("inlineCode",{parentName:"li"},"POST")," requests, and attach a ",(0,a.kt)("inlineCode",{parentName:"li"},"X-HTTP-Method-Override")," header."),(0,a.kt)("li",{parentName:"ul"},"If the request errors, it will show an alert which, if in debug mode, can be clicked to show a full error modal."),(0,a.kt)("li",{parentName:"ul"},"You can supply a ",(0,a.kt)("inlineCode",{parentName:"li"},"background: false")," option, which will run the request synchronously. However, this should almost never be done.")),(0,a.kt)("p",null,"Otherwise, the API for using ",(0,a.kt)("inlineCode",{parentName:"p"},"app.request")," is the same as that for ",(0,a.kt)("inlineCode",{parentName:"p"},"m.request"),"."))}d.isMDXComponent=!0}}]);