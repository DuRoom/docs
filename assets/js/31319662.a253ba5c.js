"use strict";(self.webpackChunkduroom_docs=self.webpackChunkduroom_docs||[]).push([[1346],{3905:function(e,t,a){a.d(t,{Zo:function(){return h},kt:function(){return c}});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var r=n.createContext({}),d=function(e){var t=n.useContext(r),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},h=function(e){var t=d(e.components);return n.createElement(r.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,i=e.originalType,r=e.parentName,h=l(e,["components","mdxType","originalType","parentName"]),p=d(a),c=o,m=p["".concat(r,".").concat(c)]||p[c]||u[c]||i;return a?n.createElement(m,s(s({ref:t},h),{},{components:a})):n.createElement(m,s({ref:t},h))}));function c(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=a.length,s=new Array(i);s[0]=p;var l={};for(var r in t)hasOwnProperty.call(t,r)&&(l[r]=t[r]);l.originalType=e,l.mdxType="string"==typeof e?e:o,s[1]=l;for(var d=2;d<i;d++)s[d]=a[d];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},9745:function(e,t,a){a.r(t),a.d(t,{assets:function(){return h},contentTitle:function(){return r},default:function(){return c},frontMatter:function(){return l},metadata:function(){return d},toc:function(){return u}});var n=a(7462),o=a(3366),i=(a(7294),a(3905)),s=["components"],l={},r="Internationalization",d={unversionedId:"extend/i18n",id:"extend/i18n",title:"Internationalization",description:"DuRoom features a powerful translation system (based on Symfony's translator and ICU MessageFormat) that allows the interface to display information in virtually any language. You should consider taking advantage of DuRoom's translator as you develop your extension, even if you have no intention of using it in more than a single language.",source:"@site/docs/extend/i18n.md",sourceDirName:"extend",slug:"/extend/i18n",permalink:"/extend/i18n",draft:!1,editUrl:"https://github.com/DuRoom/docs/tree/master/docs/extend/i18n.md",tags:[],version:"current",frontMatter:{},sidebar:"extendSidebar",previous:{title:"Interactive Components",permalink:"/extend/interactive-components"},next:{title:"Translating DuRoom",permalink:"/extend/language-packs"}},h={},u=[{value:"How DuRoom Translates",id:"how-duroom-translates",level:2},{value:"Locale File",id:"locale-file",level:2},{value:"Adding Keys",id:"adding-keys",level:3},{value:"Adding Translations",id:"adding-translations",level:3},{value:"Literal Blocks",id:"literal-blocks",level:4},{value:"Key References",id:"key-references",level:4},{value:"Using the Translator",id:"using-the-translator",level:2},{value:"Including Variables",id:"including-variables",level:2},{value:"Adding HTML Tags",id:"adding-html-tags",level:3},{value:"Pluralization and ICU MessageFormat",id:"pluralization-and-icu-messageformat",level:3},{value:"Dealing with Gender",id:"dealing-with-gender",level:3},{value:"Server-side Translation",id:"server-side-translation",level:2},{value:"Registering Locales",id:"registering-locales",level:2},{value:"Appendix A: Standard Key Format",id:"appendix-a-standard-key-format",level:2},{value:"Namespacing Translations",id:"namespacing-translations",level:3},{value:"\u27a1 The top-level key indicates <em>which component uses the translation</em>.",id:"-the-top-level-key-indicates-which-component-uses-the-translation",level:4},{value:"\u27a1 The second-level key indicates <em>which interface uses the translation</em>.",id:"-the-second-level-key-indicates-which-interface-uses-the-translation",level:4},{value:"\u27a1 The third-level key indicates <em>which part of the UI uses the translation</em>.",id:"-the-third-level-key-indicates-which-part-of-the-ui-uses-the-translation",level:4},{value:"Naming Identifier Keys",id:"naming-identifier-keys",level:3},{value:"\u27a1 The suffix indicates <em>how the translation is used</em>.",id:"-the-suffix-indicates-how-the-translation-is-used",level:4},{value:"\u27a1 The root indicates <em>what the translation says</em>.",id:"-the-root-indicates-what-the-translation-says",level:4},{value:"Reusing Translations",id:"reusing-translations",level:3},{value:"Adding Comments",id:"adding-comments",level:3},{value:"Appendix B: Coding for the World",id:"appendix-b-coding-for-the-world",level:2},{value:"Eliminate All Hardcoded Text!",id:"eliminate-all-hardcoded-text",level:3},{value:"Avoid Hardcoded Syntax!",id:"avoid-hardcoded-syntax",level:3},{value:"Keep an Eye Out for Plurals!",id:"keep-an-eye-out-for-plurals",level:3},{value:"Reuse Translations, Not Keys!",id:"reuse-translations-not-keys",level:3}],p={toc:u};function c(e){var t=e.components,a=(0,o.Z)(e,s);return(0,i.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"internationalization"},"Internationalization"),(0,i.kt)("p",null,"DuRoom features a powerful translation system (based on ",(0,i.kt)("a",{parentName:"p",href:"https://symfony.com/doc/5.2/translation.html"},"Symfony's translator")," and ",(0,i.kt)("a",{parentName:"p",href:"https://symfony.com/doc/5.2/translation/message_format.html"},"ICU MessageFormat"),") that allows the interface to display information in virtually any language. You should consider taking advantage of DuRoom's translator as you develop your extension, even if you have no intention of using it in more than a single language."),(0,i.kt)("p",null,"For one thing, this system will allow you to change the information displayed by your extension without editing the actual code. It will also give you the tools needed to efficiently deal with phenomena such as pluralization and agreement for gender. And you never know: it may come in handy later if you decide you want to add more languages and make your extension available to users around the world!"),(0,i.kt)("p",null,"This guide will show you how to ",(0,i.kt)("a",{parentName:"p",href:"#locale-file"},"create a locale file")," containing language resources for your extension, and how to ",(0,i.kt)("a",{parentName:"p",href:"#using-the-translator"},"use the translator")," to access those resources from within your code. You will learn how to deal with more complex translations involving ",(0,i.kt)("a",{parentName:"p",href:"#including-variables"},"variables")," and ",(0,i.kt)("a",{parentName:"p",href:"#adding-html-tags"},"HTML tags"),", as well as ",(0,i.kt)("a",{parentName:"p",href:"#handling-pluralization"},"pluralization")," and ",(0,i.kt)("a",{parentName:"p",href:"#gender"},"gender"),"."),(0,i.kt)("p",null,"We will also describe the ",(0,i.kt)("a",{parentName:"p",href:"#appendix-a:-standard-key-format"},"standard format")," to be followed when developing language resources for DuRoom, and offer ",(0,i.kt)("a",{parentName:"p",href:"#appendix-b:-coding-for-the-world"},"some tips")," that can help you make your language resources easier to localize. But first, let's begin with an overview of how DuRoom prioritizes resources when displaying output for a third-party extension."),(0,i.kt)("h2",{id:"how-duroom-translates"},"How DuRoom Translates"),(0,i.kt)("p",null,"In your code, instead of hardcoding strings in a language, you will call the ",(0,i.kt)("inlineCode",{parentName:"p"},"trans")," method on a translator object, providing a unique translation key and optionally some variables.\nThen, when users visit the page, DuRoom will look in its registered translation files for a matching translation."),(0,i.kt)("p",null,"DuRoom pulls translations from several sources:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Locale files included in extension source code."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/extend/language-packs"},"Language packs"),", which include translations for multiple extensions.")),(0,i.kt)("p",null,"As a rule, a DuRoom site can only display translations corresponding to the language packs that have been installed on that site. But DuRoom will do its level best ","\u2014"," within this limitation ","\u2014"," to render your extension's output in some sort of user-readable language:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"It will begin by looking for a translation in the user's preferred display language."),(0,i.kt)("li",{parentName:"ol"},"If it can't find one, it will look for a translation in the forum's default language."),(0,i.kt)("li",{parentName:"ol"},'As a last-ditch effort, it will look for a "generic" English translation of the output.'),(0,i.kt)("li",{parentName:"ol"},"If none of the above are available, it will give up and display a translation key.")),(0,i.kt)("p",null,"Since English translations could be the only thing standing between forum users and unsightly translation keys, we strongly recommend including a complete set of English resources with every extension. (You will also need to include English resources if you wish to list your extension on the DuRoom Marketplace, when that launches). Generally, extension developers will include English translations in their extension, and other language translations in a ",(0,i.kt)("a",{parentName:"p",href:"/extend/language-packs"},"language pack"),"."),(0,i.kt)("h2",{id:"locale-file"},"Locale File"),(0,i.kt)("p",null,"DuRoom's language resources use the ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/YAML"},"YAML")," file format. The locale files for a third-party extension need to be stored in the extension's ",(0,i.kt)("inlineCode",{parentName:"p"},"locale")," folder. Each locale file should be named using the ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes"},"ISO 639-1 code"),' for the language it contains. For example, a file containing French translations should be named  "',(0,i.kt)("inlineCode",{parentName:"p"},"fr.yml"),'".'),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"If you wish to provide support for a specific locale, you can add an underscore followed by an ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/ISO_3166-1#Current_codes"},"ISO 3166-1 alpha-2"),' country code; the filename for French as spoken in Canada, for example, would be "',(0,i.kt)("inlineCode",{parentName:"p"},"fr_CA.yml"),'". But you should be sure to include a locale file containing "generic" translations for the same language, so DuRoom will have something it can fall back on in the event a user specifies a locale that you haven\'t provided for.'))),(0,i.kt)("p",null,"The extension skeleton includes a ",(0,i.kt)("inlineCode",{parentName:"p"},"locale/en.yml")," template where you can put your extension's English translations. If you want to add resources for another language or locale, just duplicate the template and give it an appropriate filename. Then open the file and start adding your translations!"),(0,i.kt)("h3",{id:"adding-keys"},"Adding Keys"),(0,i.kt)("p",null,"Each translation in the locale file must be preceded by a key, which you will use as the ",(0,i.kt)("strong",{parentName:"p"},"identifier")," for that translation. The ID key should be in ",(0,i.kt)("inlineCode",{parentName:"p"},"snake_case")," and followed by a colon and a space, as shown below:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"sample_key: This is a sample translation.\n")),(0,i.kt)("p",null,"You can also use keys to ",(0,i.kt)("strong",{parentName:"p"},"namespace")," your translations. For starters, the first line of the locale file should consist of a single key that collects all the translations for your extension in a single namespace. This key should exactly match your ",(0,i.kt)("a",{parentName:"p",href:"/admin#telling-the-api-about-your-extension"},"extension's ID")," ","\u2014"," ",(0,i.kt)("inlineCode",{parentName:"p"},"kebab-case")," and all."),(0,i.kt)("p",null,"Additional keys can be used to divide the extension namespace into groups. This comes in handy when you want to organize your translations according to where they appear in the user interface, for example. These intermediate namespacing keys should always be in ",(0,i.kt)("inlineCode",{parentName:"p"},"snake_case"),"."),(0,i.kt)("p",null,"Each namespacing key should also be followed by a colon. Keys should be nested according to the YAML outline format, adding two spaces of indentation for each level in the hierarchy. Put this all together, and the locale file for the ",(0,i.kt)("a",{parentName:"p",href:"/extend/start"},"Quick Start tutorial")," might look something like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'acme-hello-world:                # Namespacing for the extension; unindented.\n  alert:                         # Namespacing for alerts; indented 2 spaces.\n    hello_text: "Hello, world!"  # Identifier/translation; indented 4 spaces.\n')),(0,i.kt)("p",null,"Once you have this information in place, you can form the ",(0,i.kt)("strong",{parentName:"p"},"full translation key"),' that you will use to access a translation by listing its keys in order from extension namespace to an identifier, with periods as delimiters. For example, the full translation key for the "Hello, world!" translation would be:'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"'acme-hello-world.alert.hello_text'\n")),(0,i.kt)("p",null,"That's really all you need to know about the mechanics of key creation. Please be aware, however, that there is a standard format that developers need to follow when creating language resources for DuRoom. The rules for ",(0,i.kt)("a",{parentName:"p",href:"#namespacing-translations"},"namespacing translations")," and ",(0,i.kt)("a",{parentName:"p",href:"#naming-id-keys"},"naming ID keys")," may be found in Appendix A."),(0,i.kt)("h3",{id:"adding-translations"},"Adding Translations"),(0,i.kt)("p",null,"The examples in the preceding section have already given you the basics: you type an ID key ","\u2014"," followed by a colon and a space ","\u2014"," then you type in the translation. It's that easy! Here we would just like to add a few details that will help you deal with longer and more complex translations."),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Quotation Marks")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"You may have noticed that only one of the two sample translations in the previous section was enclosed in quotation marks. It is generally not necessary to delimit translations in this way. You should, however, use ",(0,i.kt)("strong",{parentName:"p"},"double quotes")," to enclose any translation that includes one or more of the following characters:"),(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre"},"`  !  @  #  %  &  *  -  =  [  ]  {  }  |  :  ,  <  >  ?\n")),(0,i.kt)("p",{parentName:"div"},"Since DuRoom uses curly brackets and angle brackets to denote placeholders for ",(0,i.kt)("a",{parentName:"p",href:"#including-variables"},"variables")," and ",(0,i.kt)("a",{parentName:"p",href:"#html-tags"},"HTML tags"),", respectively, it goes without saying that any translation that includes such placeholders will also need to be enclosed in double quotes."),(0,i.kt)("p",{parentName:"div"},"Furthermore, you should use ",(0,i.kt)("strong",{parentName:"p"},"single quotes")," to enclose any translation that includes one or more double quote (",(0,i.kt)("inlineCode",{parentName:"p"},'"'),") or backslash (",(0,i.kt)("inlineCode",{parentName:"p"},"\\"),") characters. This rule takes precedence! So if a translation were to include both double quotes and one or more characters from the list above ","\u2014"," as does ",(0,i.kt)("a",{parentName:"p",href:"#including-variables"},"this example"),", in which a variable placeholder is set off by quotation marks ","\u2014"," you would need to enclose it in ",(0,i.kt)("em",{parentName:"p"},"single quotes"),"."))),(0,i.kt)("h4",{id:"literal-blocks"},"Literal Blocks"),(0,i.kt)("p",null,"When you need a translation to appear as more than a single line of text, the translation should be added as a ",(0,i.kt)("strong",{parentName:"p"},"literal block"),". Enter a vertical bar (",(0,i.kt)("inlineCode",{parentName:"p"},"|"),") character where you would normally begin the translation, then add the translation below the ID key, indenting each line by an extra two spaces:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"literal_block_text: |\n  These lines will be displayed as shown here, line breaks and all.\n\n      Extra indentation is also preserved: this line will be indented 4 spaces!\n\n  Quote marks are unnecessary, even when the block contains special characters.\n")),(0,i.kt)("p",null,"The literal block ends with the last line to be indented at least two spaces more than the ID key. Quotation marks are not needed because the block is effectively delimited by this extra two spaces of indentation."),(0,i.kt)("p",null,"DuRoom's core language resources employ literal blocks mainly for email body content."),(0,i.kt)("h4",{id:"key-references"},"Key References"),(0,i.kt)("p",null,"It's not uncommon to use the same bit of text in more than one location or context. Let's assume that you want your extension to display the phrase \"Edit Stuff\" in two locations in the user interface:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"As a ",(0,i.kt)("strong",{parentName:"li"},"button")," that users can click when they want to edit some stuff"),(0,i.kt)("li",{parentName:"ul"},"As the ",(0,i.kt)("strong",{parentName:"li"},"title")," of a dialog box displayed when users click that button")),(0,i.kt)("p",null,"Your instinct might be to add a single translation ","\u2014"," let's call it \"",(0,i.kt)("inlineCode",{parentName:"p"},"edit_stuff"),'" ',"\u2014"," and use that ID key twice in your code. This approach is efficient, but it lacks flexibility: in some languages, it may not be possible to use the same phrase for both the button and the dialog title! A better way would be to define ",(0,i.kt)("em",{parentName:"p"},"two")," keys for use in your code, then set them both to reference the same translation, like so:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"edit_stuff_button: => edit_stuff    # Used in the code that creates the button.\nedit_stuff_title: => edit_stuff     # Used in the code that creates the dialog.\n\nedit_stuff: Edit Stuff              # Not used in the code.\n")),(0,i.kt)("p",null,"You can set one key to reference another by replacing its translation with an equal sign (",(0,i.kt)("inlineCode",{parentName:"p"},"="),"), a greater-than sign (",(0,i.kt)("inlineCode",{parentName:"p"},">"),"), and a space, followed by the full translation key to be referenced. When the extension is installed, DuRoom's compiler will resolve these references to create a complete set of translations it can use."),(0,i.kt)("p",null,"There's more to be said about referencing ","\u2014"," for one thing, we've totally ignored the issue of namespacing in the above example! And you may be wondering why we suggested creating three keys when two would suffice. For an explanation, see the rules for ",(0,i.kt)("a",{parentName:"p",href:"#reusing-translations"},"reusing translations")," in Appendix A."),(0,i.kt)("h2",{id:"using-the-translator"},"Using the Translator"),(0,i.kt)("p",null,"Once you've added a translation to your locale file, with appropriate namespacing and identifier keys, you can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"app.translator.trans()")," method to reference that translation in your code. For instance, the ",(0,i.kt)("inlineCode",{parentName:"p"},"js/forum/src/index.js")," file for the ",(0,i.kt)("a",{parentName:"p",href:"/extend/start"},"Quick Start tutorial")," might end up looking like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"app.initializers.add('acme-hello-world', function() {\n  alert(app.translator.trans('acme-hello-world.alert.hello_text'));\n});\n")),(0,i.kt)("p",null,"This shows the basic translation method, with no bells or whistles attached. Below you'll find examples of more complex translations involving things like ",(0,i.kt)("a",{parentName:"p",href:"#including-variables"},"variables")," and ",(0,i.kt)("a",{parentName:"p",href:"#html-tags"},"HTML tags"),". (Please note that we've omitted the namespacing in the following examples to keep them simple; if you look at the actual code, you'll find the translations are properly namespaced according to the ",(0,i.kt)("a",{parentName:"p",href:"#namespacing-translations"},"standard format"),".)"),(0,i.kt)("h2",{id:"including-variables"},"Including Variables"),(0,i.kt)("p",null,"You can include variables in translations. As an example, let's look at the code that creates the first item in DuRoom's ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/DuRoom/framework/blob/main/framework/core/js/src/forum/components/DiscussionsSearchSource.tsx"},"search results dropdown"),". This button quotes the search query entered by the user ","\u2014"," information that is passed to the translator along with the translation key, as an additional parameter:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:"harmony",harmony:!0},"{LinkButton.component({\n  icon: 'search',\n  children: app.translator.trans('all_discussions_button', {query}),\n  href: app.route('index', {q: query})\n})}\n")),(0,i.kt)("p",null,"A matching placeholder in the translation lets the translator know where it should insert the variable:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"all_discussions_button: 'Search all discussions for \"{query}\"'\n")),(0,i.kt)("p",null,"Since curly brackets are used to denote the placeholder, the translation as a whole needs to be enclosed in ",(0,i.kt)("a",{parentName:"p",href:"#quotation-marks"},"quotation marks"),". Normally, double quotes would be used; but since this particular translation is using double quotes to set off the search query, the single-quote rule takes precedence."),(0,i.kt)("h3",{id:"adding-html-tags"},"Adding HTML Tags"),(0,i.kt)("p",null,"Abstracting translations from HTML can pose a unique challenge: How do you deal with HTML elements that affect just part of the sentence? Fortunately, DuRoom gives you a way to add tags to your translations."),(0,i.kt)("p",null,"You begin by adding a key to the parameters argument for each element that you want the translator to handle. The following snippet \u2014 from the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/DuRoom/framework/blob/main/framework/core/js/src/admin/components/EditGroupModal.js"},"Edit Group modal")," of the admin interface \u2014 shows a translation key accompanied by a parameters object with one item."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:"harmony",harmony:!0},'<div className="helpText">\n  {app.translator.trans(\'icon_text\', {\n    a: <a href="https://fortawesome.github.io/Font-Awesome/icons/" tabindex="-1"/>\n  })}\n</div>\n')),(0,i.kt)("p",null,"Note that each parameter is defined using a single HTML tag, with a slash added before the closing angle bracket. You can then use HTML-style opening and closing tags in your locale file to specify which part of the translation is affected by each element. Once again, double quotes are required.\nYou can see that not all tags are passed as an argument, only those who have attributes."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'icon_text: "Enter the name of any <a>FontAwesome</a> icon class, <em>without</em> the <code>fa-</code> prefix."\n')),(0,i.kt)("p",null,"Of course, you can give a parameter any name you like ","\u2014"," you could use ",(0,i.kt)("inlineCode",{parentName:"p"},"<fred>")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"</fred>")," to enclose your link text if you really wanted to! But we recommend sticking as close as possible to the actual HTML tags being represented, so your localizers will be able to understand what's going on."),(0,i.kt)("p",null,"Localizers can reorder elements as needed, and even choose to omit tags if they so desire. But they can't add any tags of their own: the translator will simply ignore any HTML-style tag that doesn't correspond to a properly defined parameter in the code."),(0,i.kt)("h3",{id:"pluralization-and-icu-messageformat"},"Pluralization and ICU MessageFormat"),(0,i.kt)("p",null,"On occasion, you may need to provide alternate versions of a translation to accommodate pluralization of a word or phrase. DuRoom uses the",(0,i.kt)("a",{parentName:"p",href:"https://lokalise.com/blog/complete-guide-to-icu-message-format/#Pluralization"},"ICU MessageFormat")," syntax to support selecting versions of translations based on variables. The most frequent use case is pluralization and genderization."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const remaining = this.minPrimary - primaryCount;\nreturn app.translator.trans(\n  'choose_primary_placeholder',\n  { count: remaining }\n);\n")),(0,i.kt)("p",null,"This example is from the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/DuRoom/tags/blob/master/js/src/forum/components/TagDiscussionModal.js"},"Choose Tags modal")," of the Tags extension, where it tells the user how many more primary tags can be selected. Here's the English translation in ICU MessageFormat for the above code:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'choose_primary_placeholder: "{count, plural, one {Choose a primary tag} other {Choose {count} primary tags}}"\n')),(0,i.kt)("p",null,"In this case, we call the pluralization variable ",(0,i.kt)("inlineCode",{parentName:"p"},"count"),". This isn't required, but we strongly recommend using ",(0,i.kt)("inlineCode",{parentName:"p"},"count")," for consistency."),(0,i.kt)("p",null,"Of course English has only two variants: singular or plural. You may want to provide additional variants when creating translations for a language that has more than one plural form."),(0,i.kt)("p",null,"In addition to ",(0,i.kt)("inlineCode",{parentName:"p"},"=0/=1/=2/...")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"other"),", the following plural keywords are supported: ",(0,i.kt)("inlineCode",{parentName:"p"},"zero"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"one"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"two"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"few"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"many"),"."),(0,i.kt)("p",null,"See the ",(0,i.kt)("a",{parentName:"p",href:"https://symfony.com/doc/5.2/translation/message_format.html"},"Symfony Translation docs")," for more complex examples."),(0,i.kt)("h3",{id:"dealing-with-gender"},"Dealing with Gender"),(0,i.kt)("p",null,"Support for grammatical gender will be added in a future version of DuRoom. Detailed instructions will be provided here once that functionality becomes available."),(0,i.kt)("h2",{id:"server-side-translation"},"Server-side Translation"),(0,i.kt)("p",null,"Translation is generally handled by DuRoom's front-end client. However, you can use translations in your PHP code if you need to."),(0,i.kt)("p",null,"First, you'll need to get an instance of the ",(0,i.kt)("inlineCode",{parentName:"p"},"DuRoom\\Locale\\Translator")," class. You'll usually do this by typehinting this class in the constructor of your class so a translator instance is injected by the ",(0,i.kt)("a",{parentName:"p",href:"https://laravel.com/docs/8.x/container"},"IoC Container"),". If dependency injection is not available, you can use ",(0,i.kt)("inlineCode",{parentName:"p"},"resolve(Translator::class)"),". Don't forget a ",(0,i.kt)("inlineCode",{parentName:"p"},"use DuRoom\\Locale\\Translator;")," statement at the top of your PHP file!"),(0,i.kt)("p",null,"Then, the API is similar to the JavaScript Translator class. You can use ",(0,i.kt)("inlineCode",{parentName:"p"},"$translator->trans")," like you'd use ",(0,i.kt)("inlineCode",{parentName:"p"},"app.translator.trans")," in JavaScript.\nYou can learn more about the Translator's methods in ",(0,i.kt)("a",{parentName:"p",href:"https://symfony.com/doc/5.2/translation/message_format.html"},"Symfony's ",(0,i.kt)("inlineCode",{parentName:"a"},"Translator")," documentation"),", which DuRoom's ",(0,i.kt)("inlineCode",{parentName:"p"},"Translator")," extends."),(0,i.kt)("h2",{id:"registering-locales"},"Registering Locales"),(0,i.kt)("p",null,"There's one last thing you need to do before DuRoom can use your translations. You need to register them. Fortunately, DuRoom makes this pretty easy. Add the following to your ",(0,i.kt)("inlineCode",{parentName:"p"},"extend.php"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"new Extend\\Locales(__DIR__ . '/locale'),\n")),(0,i.kt)("h2",{id:"appendix-a-standard-key-format"},"Appendix A: Standard Key Format"),(0,i.kt)("p",null,"The following guidelines were created for use in the DuRoom core and bundled extensions. Their purpose is to ensure that translation keys are organized and named in a consistent fashion, so DuRoom's localizers will be able to create and maintain high-quality language packs with a minimum of difficulty."),(0,i.kt)("p",null,"Developers who wish to contribute to the development of DuRoom are expected to follow these guidelines. Third-party developers may also wish to follow them, so experienced DuRoom localizers who undertake the translation of third-party extensions will find themselves working in familiar surroundings."),(0,i.kt)("h3",{id:"namespacing-translations"},"Namespacing Translations"),(0,i.kt)("p",null,"All translations are to be organized in categories, using namespacing keys arranged in up to ",(0,i.kt)("strong",{parentName:"p"},"three")," levels. Each level provides localizers with an important bit of information about ",(0,i.kt)("em",{parentName:"p"},"where the translation is used:")),(0,i.kt)("h4",{id:"-the-top-level-key-indicates-which-component-uses-the-translation"},"\u27a1 The top-level key indicates ",(0,i.kt)("em",{parentName:"h4"},"which component uses the translation"),"."),(0,i.kt)("p",null,"The namespacing for translation keys used in official DuRoom components, including bundled extensions, should match the name of the language pack locale file for the component in question. The namespaces for DuRoom's non-extension components are fixed as shown below:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"core:        # Translations used by the DuRoom core\nvalidation:  # Translations used by Laravel's validator\n")),(0,i.kt)("p",null,"Translation keys used in an extension ","\u2014"," including any third-party extension ","\u2014"," need to be namespaced using the extension's name in ",(0,i.kt)("inlineCode",{parentName:"p"},"vendor-package")," format where the ",(0,i.kt)("inlineCode",{parentName:"p"},"duroom-")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"duroom-ext-")," prefixes are stripped from the ",(0,i.kt)("inlineCode",{parentName:"p"},"package")," (e.g, ",(0,i.kt)("inlineCode",{parentName:"p"},"duroom-tags")," for the Tags extension and ",(0,i.kt)("inlineCode",{parentName:"p"},"foo-bar")," for a ",(0,i.kt)("inlineCode",{parentName:"p"},"foo/duroom-ext-bar")," extension)."),(0,i.kt)("p",null,"There should be only ",(0,i.kt)("strong",{parentName:"p"},"one")," first-level prefix in any locale file; it should be the first line in the locale file."),(0,i.kt)("h4",{id:"-the-second-level-key-indicates-which-interface-uses-the-translation"},"\u27a1 The second-level key indicates ",(0,i.kt)("em",{parentName:"h4"},"which interface uses the translation"),"."),(0,i.kt)("p",null,"Since DuRoom doesn't have all that many interfaces, we've come up with a short list of second-level keys for you to choose from. We've included the more frequently used ones in the locale file template created with the extension skeleton. Below you will find the complete list, with explanations:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"admin:       # Translations used by the admin interface.\nforum:       # Translations used by the forum user interface.\nlib:         # Translations used by either of the above.\nviews:       # Translations used outside the normal JS client.\napi:         # Translations used in messages output by the API.\nemail:       # Translations used in emails sent by DuRoom.\n")),(0,i.kt)("p",null,"The first four keys correspond roughly to the directories containing the code where the translations in that namespace will be used. (Most of your keys will probably go in ",(0,i.kt)("inlineCode",{parentName:"p"},"admin")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"forum"),".) The remaining two keys are a bit different: the ",(0,i.kt)("inlineCode",{parentName:"p"},"api")," namespace is for translations used in messages output by the API, while the ",(0,i.kt)("inlineCode",{parentName:"p"},"email")," namespace contains the resources for all emails sent by the forum."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"ref:         # Translations referenced by more than one key.\ngroup:       # Translations used as default group names.\n")),(0,i.kt)("p",null,"These two keys don't correspond to interfaces; they're for translations that require special handling. We'll explain how to use the ",(0,i.kt)("inlineCode",{parentName:"p"},"ref")," namespace when we talk about ",(0,i.kt)("a",{parentName:"p",href:"#reusing-translations"},"reusing translations"),". The ",(0,i.kt)("inlineCode",{parentName:"p"},"group")," namespace holds the default group names, which are translated by the server rather than at the front end."),(0,i.kt)("h4",{id:"-the-third-level-key-indicates-which-part-of-the-ui-uses-the-translation"},"\u27a1 The third-level key indicates ",(0,i.kt)("em",{parentName:"h4"},"which part of the UI uses the translation"),"."),(0,i.kt)("p",null,"The keys in this level are not so rigidly defined. Their main purpose is to chop the UI up into manageable chunks, so localizers can find the translations and see for themselves how they are used by the software. (Third-level keys aren't used in the ",(0,i.kt)("inlineCode",{parentName:"p"},"ref")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"group")," namespaces, which don't need chopping.)"),(0,i.kt)("p",null,"If you're modifying an existing location ","\u2014"," to add a new setting to the Settings page, for example ","\u2014"," you should copy our namespacing so experienced DuRoom localizers will know at a glance exactly where the new translations are displayed. See English translations in ",(0,i.kt)("inlineCode",{parentName:"p"},"duroom/core")," and bundled extensions for examples."),(0,i.kt)("p",null,"If your extension adds a new location ","\u2014"," such as a new dialog box ","\u2014"," you should feel free to create a new third-level key to namespace the translations that go there. Take a couple minutes to familiarize yourself with the namespacing in the locale files linked above, then create a new key that fits in with that scheme."),(0,i.kt)("p",null,"As a general rule, third-level keys should be short ","\u2014"," no more than one or two words ","\u2014"," and expressed in ",(0,i.kt)("inlineCode",{parentName:"p"},"snake_case"),". They should be descriptive of the locations where the translations are used."),(0,i.kt)("h3",{id:"naming-identifier-keys"},"Naming Identifier Keys"),(0,i.kt)("p",null,"Like the third-level namespacing keys, identifier keys should be expressed in ",(0,i.kt)("inlineCode",{parentName:"p"},"snake_case"),". ID keys should be arranged in alphabetical order within each namespace, so they'll be easy for developers to find. (There is one exception to this rule! ID keys in the ",(0,i.kt)("inlineCode",{parentName:"p"},"email")," namespace should be listed just as they appear in your mail client: ",(0,i.kt)("inlineCode",{parentName:"p"},"subject")," first, then ",(0,i.kt)("inlineCode",{parentName:"p"},"body"),".)"),(0,i.kt)("p",null,"The typical ID key consists of two parts ","\u2014"," a ",(0,i.kt)("strong",{parentName:"p"},"root")," and a ",(0,i.kt)("strong",{parentName:"p"},"suffix")," ","\u2014"," each of which may be omitted in certain circumstances. Just as the namespacing keys tell localizers ",(0,i.kt)("em",{parentName:"p"},"where the translation is used"),", each part of the ID key provides a further bit of information about the translation:"),(0,i.kt)("h4",{id:"-the-suffix-indicates-how-the-translation-is-used"},"\u27a1 The suffix indicates ",(0,i.kt)("em",{parentName:"h4"},"how the translation is used"),"."),(0,i.kt)("p",null,"We'll start with the suffix because it's the most important part of the key name. It tells localizers what sort of object they should look for when trying to find the translation in the interface. For example, the suffixes in the following list are used for GUI objects more or less related to user operations:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"_button:        # Used for buttons (including dropdown menu items).\n_link:          # Used for links that are not shown graphically as buttons.\n_heading:       # Used for headings in tables and lists.\n_label:         # Used for the names of data fields, checkbox settings, etc.\n_placeholder:   # Used for placeholder text displayed in fields.\n")),(0,i.kt)("p",null,"These suffixes are used for informative or descriptive text elements:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"_confirmation:  # Used for messages displayed to confirm an operation.\n_message:       # Used for messages that show the result of an operation.\n_text:          # Used for any text that is not a message, title, or tooltip.\n_title:         # Used for text displayed as the title of a page or modal.\n_tooltip:       # Used for text displayed when the user hovers over something.\n")),(0,i.kt)("p",null,"And there are two suffixes that are used only in the ",(0,i.kt)("inlineCode",{parentName:"p"},"email")," namespace:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"_body:          # Used for the content of the email message.\n_subject:       # Used for the subject line of the email message.\n")),(0,i.kt)("p",null,"The above is a complete listing of the suffixes available for use in locale files. You should take care to use them consistently, as doing so will make life easier for localizers. If you feel something is missing from the list, please file an issue with the developers; we'll consider adding a new suffix if the situation warrants it."),(0,i.kt)("p",null,"Suffixes should be ",(0,i.kt)("strong",{parentName:"p"},"omitted")," from ID keys for ",(0,i.kt)("a",{parentName:"p",href:"#reusing-translations"},"reused translations")," in the ",(0,i.kt)("inlineCode",{parentName:"p"},"ref:")," namespace. This is because you can't be sure these translations will always be used in the same context. Adding a new context would mean changing the key name ",(0,i.kt)("em",{parentName:"p"},"everywhere it's referenced")," ","\u2026"," so it's best to keep these translations generic."),(0,i.kt)("h4",{id:"-the-root-indicates-what-the-translation-says"},"\u27a1 The root indicates ",(0,i.kt)("em",{parentName:"h4"},"what the translation says"),"."),(0,i.kt)("p",null,"In other words, it should be a brief summation of the translation's content. If the translation is a very short phrase ","\u2014"," no more than a few words long ","\u2014"," you may want to use it verbatim (in ",(0,i.kt)("inlineCode",{parentName:"p"},"snake_case"),", of course). If it's very long, on the other hand, you should try to boil it down to as few words as possible."),(0,i.kt)("p",null,"In some cases, the summary may be replaced by a description of the object's function. This is commonly seen in buttons. The button that submits a form should be identified as a ",(0,i.kt)("inlineCode",{parentName:"p"},"submit_button"),' regardless of whether the translation says "OK" or "Save Changes". In a similar vein, the button that dismisses a dialog or message box is always a ',(0,i.kt)("inlineCode",{parentName:"p"},"dismiss_button"),', even if it actually reads "OK" or "Cancel".'),(0,i.kt)("p",null,"The root may also be ",(0,i.kt)("strong",{parentName:"p"},"omitted")," in certain cases ","\u2014"," usually when the suffix alone is sufficient to identify the translation. For example, it's unlikely that a page or dialog box will have more than one title ","\u2026"," and like as not, the content of the title is already given in the third-level namespacing! So the suffix can stand alone."),(0,i.kt)("p",null,"Suffixes are also sufficient to identify the subject and body components of an email message since each email will have only one subject line and one body. Note that the leading underscore is omitted in such cases: you would use just ",(0,i.kt)("inlineCode",{parentName:"p"},"title"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"subject"),", or ",(0,i.kt)("inlineCode",{parentName:"p"},"body")," as the ID key."),(0,i.kt)("h3",{id:"reusing-translations"},"Reusing Translations"),(0,i.kt)("p",null,"DuRoom's unique ",(0,i.kt)("a",{parentName:"p",href:"#key-references"},"key references")," fulfill the same role as YAML anchors, but they're better in one respect: you can even reference keys in a different file! For this reason, you need to use the ",(0,i.kt)("strong",{parentName:"p"},"full translation key")," when referencing. Here's a more realistic example of how referencing works, complete with namespacing:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"core:\n\n  forum:\n    header:\n      log_in_link: => core.ref.log_in\n\n    log_in:\n      submit_button: => core.ref.log_in\n      title: => core.ref.log_in\n\n  ref:\n    log_in: Log In\n")),(0,i.kt)("p",null,"As you can see, we want to reuse a single translation in three different contexts (including two locations): (1) as a link displayed in the site header, (2) as a button displayed in the Log In modal, and (3) as the title of that modal. So all three of these keys have been set to reference the same full translation key."),(0,i.kt)("p",null,"The reused translation is identified by a key that omits the suffix ","\u2014"," as specified ",(0,i.kt)("a",{parentName:"p",href:"#naming-identifier-keys"},"above")," ","\u2014"," and is placed in the ",(0,i.kt)("inlineCode",{parentName:"p"},"ref")," namespace. The latter measure is needed to avoid conflicts that can occur if a reused translation is given the same name as a second-level namespacing key. (The ",(0,i.kt)("inlineCode",{parentName:"p"},"email")," keys are a case in point.)"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"ref")," namespace also makes it easy to track translation reuse. Imagine what would happen if you set the scalars for the button and title to reference ",(0,i.kt)("inlineCode",{parentName:"p"},"core.forum.header.log_in_link")," instead:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'core:\n\n  forum:\n    header:\n      log_in_link: => Log In\n\n    log_in:\n      submit_button: => core.forum.header.log_in_link  # Never reference keys\n      title: => core.forum.header.log_in_link          # that aren\'t in "ref"!\n')),(0,i.kt)("p",null,"It would very easy to change the translation for the header link without realizing that you're also changing things in the Log In modal ","\u2014"," to say nothing of any extensions that might also be referencing that key! This sort of thing will be less likely to occur if you keep your reused translations in the ",(0,i.kt)("inlineCode",{parentName:"p"},"ref")," namespace."),(0,i.kt)("p",null,"For this reason, any key references in the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/DuRoom/framework/blob/main/framework/core/locale/core.yml"},"core resources")," ",(0,i.kt)("strong",{parentName:"p"},"must")," point to keys in the ",(0,i.kt)("inlineCode",{parentName:"p"},"core.ref")," namespace. Key references in the resources for bundled extensions may point to either of two locations:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Extension-specific translations should go in the ",(0,i.kt)("inlineCode",{parentName:"p"},"ref")," namespace of the extension's locale file.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Translations used by both the extension and the core should go in the ",(0,i.kt)("inlineCode",{parentName:"p"},"core.ref")," namespace."))),(0,i.kt)("p",null,"Third-party extensions are welcome to reference keys in the ",(0,i.kt)("inlineCode",{parentName:"p"},"core.ref")," namespace, but please be aware that we cannot add translations to this namespace based on reuse in third-party extensions. A third-party dev who wants to reuse a translation from a namespace other than ",(0,i.kt)("inlineCode",{parentName:"p"},"core.ref")," will need to add a properly keyed duplicate translation to the extension's locale file."),(0,i.kt)("p",null,"No extension should ever reference a key from another extension, as doing so will result in a dependency."),(0,i.kt)("p",null,"One final caution: translation keys in the ",(0,i.kt)("inlineCode",{parentName:"p"},"ref")," namespace should ",(0,i.kt)("strong",{parentName:"p"},"never")," be inserted directly in code. This is because localizers may end up creating a translation to replace every reference to a reused translation key ","\u2014"," in which case they would be within their rights to remove that key from the locale file. If such a key were being used in the code, it would end up without a matching resource to translate it!"),(0,i.kt)("h3",{id:"adding-comments"},"Adding Comments"),(0,i.kt)("p",null,"Comments (and empty lines) should be added to locale files so localizers will find them easier to navigate."),(0,i.kt)("p",null,"We've included some ",(0,i.kt)("strong",{parentName:"p"},"block comments")," in the locale file template included with the extension skeleton. They are there to remind developers of some basic concepts: translation keys should not be used in more than one place; keys for reused translations should never be inserted directly in code; and so forth."),(0,i.kt)("p",null,"You should add ",(0,i.kt)("strong",{parentName:"p"},"comment lines")," above every second- or third-level namespacing key, to give localizers a more complete description of the location covered by that namespace. When copying existing keys, be sure to copy the comment as well (and modify it if necessary). If you add a new third-level key, remember to preface it with a comment to explain the location being added."),(0,i.kt)("p",null,"You may also wish to add ",(0,i.kt)("strong",{parentName:"p"},"inline comments")," after a specific translation to provide localizers with further information about that translation (such as the fact that a translation can be pluralized if necessary)."),(0,i.kt)("h2",{id:"appendix-b-coding-for-the-world"},"Appendix B: Coding for the World"),(0,i.kt)("p",null,"In this appendix, we'd like to offer a few tips that may help you to avoid some of the more common pitfalls in the internationalization process. Abstracting language from code is easily one of the more humdrum tasks a programmer has to deal with, but if you don't give due attention to the subtleties involved, you're likely to end up creating your localizers an unnecessary headache or two."),(0,i.kt)("p",null,"Of course, it's not just about making life easier for localizers. Because when they get headaches, they will come to you for help ","\u2014"," often months (or even years) after you've put the project behind you and moved on to something else! It's the sort of situation where an ounce or two of prevention may indeed be worth several pounds of cure further down the road ","\u2026"," for everybody involved."),(0,i.kt)("p",null,"It's probably impossible to avoid localization issues completely; there are just too many variables. But by following a few simple guidelines, you should be able to head off many issues before they happen."),(0,i.kt)("h3",{id:"eliminate-all-hardcoded-text"},"Eliminate All Hardcoded Text!"),(0,i.kt)("p",null,"This probably goes without saying. After all, if you're going to go to the trouble of extracting translations, you might as well finish the job, right? Well, yes, but that's easier said than done. It's really quite unusual to find a program that doesn't have at least a few bits of hardcoded text floating around somewhere."),(0,i.kt)("p",null,"Even tiny bits of text can cause problems for localizers. A comma here, a colon there ","\u2026"," perhaps a pair of brackets inserted to make the page more legible: such things can and do cause issues for localizers. After all, not all languages use the same glyphs for these things! Just one hardcoded space can be a problem for someone trying to translate the interface into a language that doesn't use spaces to separate words."),(0,i.kt)("p",null,"Generally speaking, any displayed text that isn't supplied by a variable or the result of a calculation ",(0,i.kt)("em",{parentName:"p"},"must")," be included in the locale files. That's easily said, but actually doing it takes a bit of perseverance."),(0,i.kt)("h3",{id:"avoid-hardcoded-syntax"},"Avoid Hardcoded Syntax!"),(0,i.kt)("p",null,"Hardcoded text isn't the only way that code can create problems for localizers. Hardcoded syntax issues occur when the code forces words into a specific order that just won't work in other languages. They are generally the result of using two translations where just one would be more appropriate."),(0,i.kt)("p",null,"For an example, let's look at the line of text that's printed near the bottom of the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/DuRoom/framework/blob/main/framework/core/js/src/forum/components/LogInModal.tsx"},"Log In modal"),":"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Don't have an account? ",(0,i.kt)("a",{parentName:"p",href:"#"},"Sign Up"))),(0,i.kt)("p",null,"We originally coded this line as two translations, which were separated by a hardcoded space:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'before_sign_up_link: "Don\'t have an account?"\nsign_up: Sign Up\n')),(0,i.kt)("p",null,"There were good reasons for doing it this way. For one thing, it made it easy to turn the second half into a link. And since the second translation is reused elsewhere, keeping it separate seemed like a no-brainer."),(0,i.kt)("p",null,"But there were problems with this approach. The hardcoded space seemed likely to pose issues for some localizers, as mentioned above. And splitting this text into two strings would make it impossible to render the line as a single sentence with the link embedded in the middle:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"If you don't have an account yet, you can ",(0,i.kt)("a",{parentName:"p",href:"#"},"sign up")," instead!")),(0,i.kt)("p",null,"Since it seemed possible that a localizer might need this sort of flexibility, we opted to abstract the line as a single translation, using HTML-style tags to enclose the link text:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'sign_up_text: "Don\'t have an account? <a>Sign Up</a>"\n')),(0,i.kt)("p",null,"This puts the (formerly hardcoded) space in the translation, so localizers who don't need it can remove it. And the tags can be positioned freely within the translation, making this approach much more flexible."),(0,i.kt)("p",null,"The moral of this story is: when you've got two adjacent chunks of text which seem related to each other grammatically ","\u2014"," or even semantically ","\u2014"," you should think about finding a way to incorporate them both in a single translation. Your localizers may have cause to thank you!"),(0,i.kt)("p",null,"We might also conclude that the presence of little bits of hardcoded text ","\u2014"," such as the hardcoded space in this example ","\u2014"," may be a sort of ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Code_smell"},"code smell")," indicating the presence of a deeper issue. This isn't always the case, but it's a possibility that's worth taking into consideration."),(0,i.kt)("h3",{id:"keep-an-eye-out-for-plurals"},"Keep an Eye Out for Plurals!"),(0,i.kt)("p",null,"They are surprisingly easy to overlook. Of course, the need for pluralization support is fairly obvious here:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Toby likes this.\nYou like this.\nToby and Franz like this.")),(0,i.kt)("p",null,"And the situation is complicated by the presence of the second-person pronoun, since it always takes the plural form in English, even when we're talking about one person. That's why the ",(0,i.kt)("inlineCode",{parentName:"p"},"app.translator")," call is so complicated in the code that outputs the above sentences for the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/DuRoom/likes/blob/master/js/src/forum/addLikesList.js"},"Likes extension"),"."),(0,i.kt)("p",null,"Now look at this similar set of sentences, output by similar code in the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/DuRoom/mentions/blob/master/js/src/forum/addMentionedByList.js"},"Mentions extension"),":"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Toby replied to this.\nYou replied to this.\nToby and Franz replied to this.")),(0,i.kt)("p",null,"In English, the simple past tense is not affected by pluralization. Since the verb phrase is always the same, it would be fairly easy to ignore the plurals and use the ",(0,i.kt)("inlineCode",{parentName:"p"},"app.translator.trans()")," method to produce the single necessary translation. Of course, that simply wouldn't work for the French localizer, who needs to inflect the verb differently in each of the above three sentences."),(0,i.kt)("p",null,"This is the sort of situation where the humdrum chore of language abstraction requires a bit of extra care and attention. Remember to ask yourself whether each noun (or pronoun) can be pluralized. If it can, make sure to pass an appropriate variable to the translator. Of course, you don't need to provide any variant translations in the English resources ","\u2026"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'mentioned_by_text: "{users} replied to this."       # Can be pluralized ...\nmentioned_by_self_text: "{users} replied to this."  # Can be pluralized ...\n')),(0,i.kt)("p",null,"\u2026"," but it would be a very good idea to add a comment after the translations in question, to alert localizers to the fact that the code will support the addition of such variants, should they be necessary."),(0,i.kt)("h3",{id:"reuse-translations-not-keys"},"Reuse Translations, Not Keys!"),(0,i.kt)("p",null,"If the namespacing keys combine to form a complete specification of where a translation is used, and the ID key specifies exactly how the translation is used and what it says, then it stands to reason that every full translation key must be unique. In other words: ",(0,i.kt)("em",{parentName:"p"},"you should never use the same key more than once!")),(0,i.kt)("p",null,"Although this may sound inefficient, there's a good reason for doing things this way: it's the easiest way to ensure that localizers will have the flexibility they need. If you reuse keys in your code, you'll eventually hit a snag. Your localizers will be unable to find a single expression that fits every context where you've used some key or other ","\u2026"," and then they'll start bugging you to fix your code."),(0,i.kt)("p",null,"Fortunately, you can avoid many such issues if you simply take care to ",(0,i.kt)("a",{parentName:"p",href:"#namespacing-translations"},"namespace translations")," correctly, ",(0,i.kt)("a",{parentName:"p",href:"#naming-identifier-keys"},"name your ID keys")," appropriately, and always ",(0,i.kt)("a",{parentName:"p",href:"#reusing-translations"},"reuse translations")," instead of keys. Though it may seem like a bother, in the long run, the ",(0,i.kt)("a",{parentName:"p",href:"#appendix-a:-standard-key-format"},"standard format")," will make localization much easier for ",(0,i.kt)("em",{parentName:"p"},"everyone"),"."))}c.isMDXComponent=!0}}]);